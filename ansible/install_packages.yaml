# yaml-language-server: $schema= https://raw.githubusercontent.com/ansible/schemas/main/f/ansible.json

- name: Install system packages
  hosts: all
  vars:
    system_packages:
      - entr
      - eza
      - fzf
      - zoxide
      - thefuck
      - grc
      - zinit
      - atuin
      - jq
      - fd
      - sd
      - yq
      - ripgrep
      - delta
      - direnv
      # - nerdfonts
      - tldr
      - stow
      - mise
      - oh-my-posh
      - kubectl
      - zsh-autosuggestions
      - gh
      - nodejs
      - pamburus/tap/hl
      - viu # image viewer
      - broot
      
  tasks:
    - name: Install system packages
      ansible.builtin.homebrew:
        name: "{{ system_packages }}"
        state: present
    - name: Install zk
      ansible.builtin.git:
         repo: 'https://github.com/sirupsen/zk.git'
         dest: '~/zk'
    - name: Install mise
      block:
        - name: load mise
          ansible.builtin.shell:
             cmd: "curl https://mise.run | sh"
        - name: init mise
          ansible.builtin.shell:
             cmd: ~/.local/bin/mise activate zsh >> ~/.zshrc.mise
    - name: Install terminal
      ansible.builtin.homebrew:
       name: wezterm
       state: present
    - name: install nvim
      ansible.builtin.shell:
             cmd: "mise install neovim@0.10.0"
    - name: install go
      ansible.builtin.shell:
             cmd: "mise install go@latest"
    - name: install zellij
      block:
        - name: install session pickier
          ansible.builtin.shell:
             cmd: "wget https://github.com/laperlej/zellij-choose-tree/releases/latest/download/zellij-choose-tree.wasm -O ~/.config/zellij/plugins/zellij-choose-tree.wasm"
        - name: install forgot plugin
          ansible.builtin.shell:
             cmd: "wget https://github.com/karimould/zellij-forgot/releases/download/0.4.0/zellij_forgot.wasm -O ~/.config/zellij/plugins/zellij_forgot.wasm"
        - name: install status bar
          ansible.builtin.shell:
             cmd: "wget https://github.com/dj95/zjstatus/releases/latest/download/zjstatus.wasm -O ~/.config/zellij/plugins/zjstatus.wasm"
